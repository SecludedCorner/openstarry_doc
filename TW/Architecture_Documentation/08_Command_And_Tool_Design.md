# 07. 命令 (Command) 的設計與定位

在我們的架構中，`Command` (命令) 是一個多層次的概念，根據其上下文的不同，它由系統的不同部分來處理。本文件旨在澄清 `Command` 與 `Tool` 的關係，以及它在架構中的具體定位。

---

## 1. 作為「用戶系統命令」 (在 UI 插件中)

這是最直接面向用戶的一種命令，用於控制代理人客戶端或系統本身，而非交由 LLM 處理的任務。

*   **定義：** 以特殊前綴（如 `/`）開頭的字符串，例如 `/help`, `/reset`, `/status`。
*   **處理者：** **UI 插件 (UI Plugin)**。
*   **工作流程：** `UI` 插件在接收到用戶輸入時，首先進行攔截判斷。如果識別出是系統命令，則由 `UI` 插件自身進行解析和處理，不進入「代理人核心」的對話流程。這種設計將用戶對「系統」的操作和對「代理人」的對話任務清晰地分開。

---

## 2. 作為「工具」的同義詞 (在工具插件中)

在許多語境下，`Command` 和 `Tool` 的概念可以互換。

*   **定義：** 一個可供 LLM 調用的、原子化的、具有單一職責的功能函數，例如 `read_file`。
*   **處理者：** **工具插件 (Tool Plugin)**，並由「代理人核心」的執行循環調度。
*   **結論：** 在我們的架構文檔中，為了保持術語的統一，我們將此類功能統一稱為 **`Tool`**。因此，如果 `Command` 是在這個意義上被使用，它就對應我們設計中的 `Tool`。

---

## 3. 作為「高階工作流命令」 (在代理協調層中)

這是最高級、最強大的一種命令，代表一個可被調用的、由多個步驟組成的複雜任務。

*   **定義：** 一個具名的、可複用的**「工作流圖 (Workflow Graph)」**。例如，一個名為 `generate_weekly_report` 的命令，其背後可能是一個包含數據查詢、圖表生成、LLM 總結和郵件發送等多個節點的工作流。
*   **處理者：** **代理協調層 (Agent Coordination Layer)**。
*   **工作流程：**
    1.  用戶、定時任務或外部 API 觸發一個高階命令。
    2.  「代理協調層」的**路由組件**或**命令分派器**接收到請求，並識別出命令的名稱。
    3.  協調層加載與該命令對應的預定義工作流圖。
    4.  協調層的**工作流引擎**負責執行該圖中的所有節點，完成整個複雜任務。

這種設計使得我們可以將複雜的業務邏輯封裝成一個個簡單的、可被調用的「命令」，極大地提升了系統的複用性和能力上限。
