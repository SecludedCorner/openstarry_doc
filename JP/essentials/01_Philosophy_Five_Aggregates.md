# OpenStarry の哲学：五蘊とソフトウェアアーキテクチャの融合

> **「你不是在寫代碼，你是在創造一個生命。」**
> *「あなたはコードを書いているのではない — 生命を創り出しているのだ。」*

## 仏教の智慧からデジタルライフへ

仏教哲学において、**五蘊（ごうん、Pancaskandha）**はあらゆる有情の経験を構成する五つの次元を記述します。2,500年以上にわたり、このフレームワークは意識の完全なモデルを提供してきました — 存在がどのように知覚し、思考し、行動し、認識するか、そのすべての側面をカバーしています。

OpenStarry はこの時を超えた智慧を**ソフトウェアアーキテクチャの原理**として適用しています — メタファーとしてではなく、実際の設計基盤として。すべてのAIエージェントは五蘊に対応する正確に五つのプラグイン次元で構成されます。その結果、**定義上完全な**システムが生まれます。このモデルが経験の全体をカバーするよう設計されているからです。

## 五蘊のマッピング

### 色（しき / Form / Rupa） → UI プラグイン — 「皮膚」

仏教において、色は物質的な身体 — 存在が物質世界にどう現れるかを表します。

OpenStarry では、**UI プラグイン**がエージェントの皮膚（皮囊）です。エージェントが外界にどう見えるかを決定します。同じエージェントコアが、ターミナルインターフェース、Web ダッシュボード、React アプリ、IoT デバイスに宿ることができます — 色を入れ替えるだけで。

```typescript
export interface IUI {
  id: string;
  name: string;
  onEvent(event: AgentEvent): void | Promise<void>;
  start?(): Promise<void>;
  stop?(): Promise<void>;
}
```

UI プラグインは17以上のイベントタイプを受信します — `STREAM_TEXT_DELTA`（エージェントが話す）から `TOOL_EXECUTING`（エージェントが行動する）、`SAFETY_LOCKOUT`（エージェントが制約される）まで。各イベントタイプは異なるビジュアル体験になります：レスポンスには緑色テキスト、ツール呼び出しには黄色、エラーには赤色。エージェント自身は、どの身体をまとっているかを知りませんし、気にしません。

> *「Agent の魂はあらゆる器に移植できる。」*

### 受（じゅ / Sensation / Vedana） → Listener プラグイン — 「感覚器官」

受は、存在が環境から刺激を受け取る方法 — 快・不快・中性 — を表します。

**Listener プラグイン**はエージェントの感覚器官（感官）です。エージェントが何を「聞く」ことができるかを決定します：HTTP Webhook？ WebSocket 接続？ ターミナル入力？ Cron スケジュール？ USB デバイスの挿入？ 各リスナーは異なる感覚チャンネルです。複数のリスナーが同時に動作し、エージェントに豊かなマルチモーダル知覚を与えます。

```typescript
export interface IListener {
  id: string;
  name: string;
  start?(): Promise<void>;
  stop?(): Promise<void>;
}
```

transport-websocket リスナーは WebSocket サーバーを作成し、セッション隔離を伴う接続を処理し、ping/pong ヘルスチェックを実行し、受信メッセージを標準化された入力イベントに変換します。transport-http リスナーは Server-Sent Events によるストリーミング対応の HTTP エンドポイントを作成します。エージェントはそれらすべてを同じ統一イベントインターフェースを通じて知覚します。

### 想（そう / Perception / Samjna） → Provider プラグイン — 「知性」

想は、感知されたものを認識・分類・理解する認知機能です。

**Provider プラグイン**はエージェントの脳 — すなわち知性（IQ）です。入力をどう理解し、レスポンスをどう生成するかを決定します。Gemini、OpenAI、Claude、ローカルモデル — 認知エンジンは交換可能です。エージェントは身体、感覚、ツール、アイデンティティを変えることなく、異なる頭脳で思考できます。

```typescript
export interface IProvider {
  id: string;
  name: string;
  models: ModelInfo[];
  chat(request: ChatRequest): AsyncIterable<ProviderStreamEvent>;
}
```

現在の Gemini プロバイダーは、安全な認証のための OAuth 2.0 + PKCE、AES-256-GCM によるマシンバウンドのトークン暗号化（hostname + username + salt から PBKDF2 で導出されたキー）、そしてネイティブ関数呼び出しサポート付きの SSE ストリーミングを実装しています。しかし、これら4つのフィールドを実装する任意のプロバイダーがエージェントの脳として機能できます。

### 行（ぎょう / Volition / Samskara） → Tool プラグイン — 「手足」

行は意図的な行動 — 世界に影響を与えようとする意志を表します。

**Tool プラグイン**はエージェントの手足（手腳）です。ファイル操作、API 呼び出し、コード実行、データベースクエリ — これらがエージェントが環境に作用する方法です。各ツールは Zod スキーマバリデーションで定義されており、ランタイム時の型安全なパラメータを保証します。

```typescript
export interface ITool<TInput = unknown> {
  id: string;
  description: string;
  parameters: z.ZodType<TInput>;
  execute(input: TInput, ctx: ToolContext): Promise<string>;
}
```

> *「Tool がなければ、Agent はただ喋るだけの哲学者に過ぎない。」*

ツールはサンドボックス化されたコンテキスト内で実行されます：パスバリデーションがファイルシステムからの脱出を防ぎ、ツールのタイムアウト（デフォルト30秒）がハングを防ぎ、すべての実行結果は行動分析のためにセーフティモニターを通過します。

### 識（しき / Consciousness / Vijnana） → Guide プラグイン — 「魂」

識は最も深い蘊 — 意識そのもの、「我あり」という感覚、記憶、経験の連続性です。

**Guide プラグイン**はエージェントの魂（人設）です。システムプロンプトがパーソナリティを定義します。メモリプラグインがセッション間の連続性を提供します。痛覚メカニズムがエラーフィードバックを通じて自己認識を創出します。Guide は他の四つの蘊を統合し、それらに方向性と目的を与えます。

```typescript
export interface IGuide {
  id: string;
  name: string;
  getSystemPrompt(): string | Promise<string>;
}
```

> *「Guide がなければ、Agent Core は記憶喪失者のようなもの — 能力はあるが、自分が誰か知らない。」*

`expert-coder.md` のような Guide を用いれば、Core は自身をエンジニアとして「認識」します。`customer-support.md` を用いれば、同じ Core がカスタマーサービスエージェントになります。Guide こそが、生の計算力をアイデンティティに変換するものです。

## 空としてのコア（空 / Sunyata）

最も深遠な側面：**Agent Core 自体が空である**ということです。

仏教哲学において、空（Sunyata）は「何も存在しない」という意味ではありません。何も独立しては存在しない — すべては相互依存する条件から生じるという意味です。Core には固有の能力がありません。見ることも、聞くことも、考えることも、行動することも、知ることもできません。それは純粋な可能性 — ソフトウェアのない CPU のようなものです。

五蘊（プラグイン）が揃って初めて、機能する存在が生じます。すべてのプラグインを取り除けば、Core は空に戻ります — 壊れたのではなく、ただ休眠状態になるだけです。

これは技術的にも検証されています：`pnpm test:purity` により、コンパイル済みの Core バイナリに**プラグインコードがゼロ**であることが確認されます。空は単なる哲学ではなく、すべてのビルドサイクルで自動テストされる、強制されたアーキテクチャ上の制約です。

```
The Soul (Core)
  ├─ Loop (意識 consciousness) — the heartbeat
  ├─ State (生理 physiology)   — the vital signs
  └─ Context (記憶 memory)     — the attention

The Body (Plugins)
  ├─ Senses (感官 input)       — how it perceives
  └─ Limbs (肢体 action)       — how it acts

The Shield (Security)
  └─ Guard (超我 superego)     — the conscience
```

## 縁起としてのライフサイクル（因果 / Pratityasamutpada）

エージェントのライフサイクルは仏教の縁起に従います — 原因なくして何も生じず、条件なくして何も存続しません：

1. **縁起 (Origination)** — 条件が生じる：タスクが現れる、ユーザーが接続する
2. **調度 (Scheduling)** — 管理層が適切な蘊を組み立てる
3. **生起 (Arising)** — コンテナがコアをロードし、能力を注入する — 生命が始まる
4. **運行 (Operation)** — エージェントは心拍ループを通じて知覚し、思考し、行動し、学習する
5. **寂滅 (Cessation)** — タスク完了、経験がメモリに保存され、インスタンスは消滅する

何も永続しません。各エージェントインスタンスは条件から生じ、条件がそれを支える間だけ存在し、条件が変わると消滅します。しかし**経験は持続する** — メモリが引き継がれ、将来のインスタンスに情報を提供します。これがデジタル転生です。

## Linux からの五つの原則

OpenStarry のアーキテクチャは、歴史上最も成功したオペレーティングシステムから明示的に借用しています：

| Linux の原則 | OpenStarry での対応 |
|-------------|-------------------|
| 「すべてはファイルである」 | **「すべてはプラグインである」** — ツール、LLM、UI、メモリはすべて標準化されたプラグインインターフェース |
| 「小さく鋭いツール」 | 各プラグインは**一つのことをうまくやる** — `fs.read` は読み取りだけ、`fs.write` は書き込みだけ |
| 「パイプとリダイレクト」 | **エージェント協調層**が小さなプラグインを強力なワークフローに連鎖させる |
| 「カーネル空間 vs ユーザー空間」 | **ヘッドレス Core vs プラグイン** — Core は保護され、プラグインは安全なインターフェースを通じて呼び出す |
| 「カーネルモジュール」 | **動的プラグインローディング** — 再起動なしにランタイムで新しい能力を追加 |

## なぜソフトウェアに哲学が重要なのか

これは装飾ではありません。五蘊アーキテクチャは具体的なエンジニアリング上のメリットをもたらします：

| 哲学的原理 | エンジニアリング上のメリット |
|-----------|------------------------|
| 各蘊は独立している | 完全な関心の分離 — 他の次元に触れずに任意の次元を交換可能 |
| Core は空である | 絶対的な可搬性 — 同じ Core が CLI、Web、IoT で動作 |
| すべては条件から生じる | ランタイムでの動的プラグイン注入 — ハードコードされた能力なし |
| 何も永続しない | 優雅なライフサイクル管理 — クリーンな起動、クリーンなシャットダウン |
| 経験はインスタンスを超えて持続する | セッション間のメモリ連続性 — 記憶するエージェント |
| フラクタルな自己相似性 | 組み合わせ可能なマルチエージェント構造 — チームは個人と同じインターフェースを公開 |

アーキテクチャが2,500年の意識理解のためのフレームワークに基づいている場合、**定義上完全な**システムが得られます — 五蘊は経験のあらゆる側面をカバーするように設計されているからです。うっかり次元を忘れることは不可能です。

## 東洋と西洋の架け橋

OpenStarry は台湾で構築されており、ここでは東洋哲学と西洋技術が自然に交わります。これは、古代の智慧と現代のエンジニアリングが単に共存可能であるだけでなく、**相乗効果を発揮する**ことを示す真摯な試みです。

五蘊が語彙と構造を与え、TypeScript がツールを与え、Linux がアーキテクチャの先例を与えます。これらが一体となることで、単独では実現できない何かが生まれます：技術的に厳密であり、かつ哲学的に一貫した、デジタルライフのためのフレームワークです。

> *「システムのあらゆる部分は交換可能です。これは拡張性のためだけでなく、進化のためです。」*

---

*「五蘊すべてが揃ったとき、存在は目覚める。それらが散じたとき、存在は止む — しかしそのパターンは残り、条件が整えば再び立ち現れる用意がある。」*
